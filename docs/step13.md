## 캐시란 
- 사용자에 입장에서 데이터를 더 빠르게, 더 효율적으로 액세스 할 수 있는 임시 데이터 저장소
> 사용 이유 : 속도 향상을 위해 캐시를 사용한다.

## 캐시를 유요할게 사용하려면
- 동일한 데이터에 대해 반복적으로 액세스 하는 상황이 많을 때 사용하는 것이 좋다.
> 잘 변하지 않은 데이터 일수록 cache를 사용할 때 더 효율적이다.

## 로컬 캐시 vs 글로벌 캐시
로컬 캐시 
- 장점: 외부 저장소를 사용하지 않아 속도가 빠르다.
- 단점: 서버마다 각기 다른 캐시를 저장하기 때문에 변경 사항이 생길 경우 동기화가 즉시 이루어지지않는다.

글로벌 캐시
- 장점: 외부 저장소를 이용하기 때문에 즉각적으로 동기화가 반영된다.
- 단점: 로컬 캐시와 비교했을때 네트워크, 디스크 비용이 발생하므로 속도가 느릴수 있으며 장애 대비가 필요하다.

## 캐시를 Redis로 선택한 이유
1. 단순한 Key-value구조와 다양항 자료 구조 지원으로 사용이 간편
> List, set, hash, Sorted Set 등 다양한 자료 구조를 지원하여 다양한 데이터 처리
2. 스프링에서 Redis 라이브러리 지원
> Redis와의 통합을 지원하는 여러 라이브러리를 제공하여 개발과 관리가 용이.
3. 데이터 만료 및 자동 삭제
> TTL(Time-To-Live) 설정이 가능하여 지정된 시간이 지나면 자동으로 데이터를 삭제하도록 관리.  
> 오래된 캐시 데이터가 차지하는 메모리를 효율적으로 관리.
4. Pub/Sub 기능
> 데이터 변경 사항을 실시간으로 전파할 수 있다. 여러 애플리케이션 인스턴스 간 캐시 일관성을 유지하는데 유용.

## 캐싱 전략(Caching Strategies)
Redis를 Cache로 사용할 때 어떻게 배치하냐에 따라 시스템 전체 성능에 큰 영향을 준다.  
그래서 전략을 세워야 한다. 이를 캐싱 전략이라고 한다. 데이터의 유형과 해당 데이터에 대한  
액세스 패턴을 잘 고려해서 선택해야 한다. 크게 읽기 전략과 쓰기 전략으로 두가지로 나뉜다.

## 읽기 전략(Read Strategies)
1. Look-aside(Lazy Loading) 전락
> 데이터를 읽는 작업이 많을 때 사용하는 전략으로 Redis를 캐시로 쓸때 많이 사용하고 Cache Aside 패턴이라고도 불린다. 
> 애플리케이션이 데이터를 읽을때, 우선 캐시를 확인하여 캐시에 데이터가 존재하면 캐시에서 읽어오고 없으면 DB에 접근해서 데이터를 직접 가져와 Redis에 저장한다.  
> 주의점: 캐시가 비어 있는 상황에서 다수의 요청이 DB로 몰리면 트래픽이 집중되어 DB 성능이 저하 될수 있다.  
> 이를 방지하기 위해 새로운 데이터를 DB에 저장할 때 캐시에 미리 올려두는 캐시 워밍 작업이 필요할 수 있다.  
> 생각: 콘서트 공연 정보를 미리 캐시에 올려두면 cache miss로 인한 DB 부하를 줄일수 있거 같다.

2. Read Through
> 캐시에서만 데이터를 읽어 오는 전략
> 데이터 동기화를 라이브러리 또는 캐시 제공자에게 위임하여 데이터 조회하는데 있어 속도가 느리다.
> 데이터 조회를 전럭으로 캐시에만 의지하여 Redis가 다운될 경우 서비스 이용에 문제가 생긴다.
> 캐시와 DB간의 데이터 동기화가 항상 이루어져 데이터 정합성 문제가 없음
> 읽기가 많은 워크로드에 적합하다.
 
## 쓰기 전략(Writing Strategies)
1. Write-around 
> DB에 데이터를 저장하고 cache miss가 발생할 경우 DB에서 데이터를 읽어와 캐시에 저장하는 방식입니다.
> 캐시가 일부 요청에서만 데이터를 저장하기 때문에 자주 읽지 않는 데이터에 적합하다.  
> 단점: 캐시와 DB간의 데이터 불일치가 발생할 수 있다는 점이다. 데이터가 수정되더라도 캐시에 즉시 반영되지 않기 때문에  
> 캐시가 최신 정보를 보장하지 못할 수 있다.

2. Write-through
> DB에 데이터를 저장할 때 캐시에도 동시에 저장하여 항상 최신 정보를 캐시에 유지하는 방식입니다.  
> 캐시와 DB간의 일관성이 보장되지만, 저장할 때마다 DB와 캐시 두단계로 저장이 이루어지므로 성능 느릴수 있다.  
> 이 방식은 자주 읽히는 데이터에 적합하나, 재사용되지 않는 데이터가 캐시에 쌓일 위험이 있어  
> expire time을 설정하여 불필요한 캐시 점유를 방지하는 것이 좋다.



## 조회가 오래 걸리는 쿼리에 대한 캐싱 시나리오
콘서트 예약 가능한 날짜 조회
> Look Aside + Write through 조합으로 사용
1. 데이터 조회  
> 사용자가 콘서트 예약 가능한 날짜를 조회하면 캐시에서 먼저 확인한다.
> 캐시가 비어 있거나 해당 날짜 정보가 없으면 DB에서 조회하고 그결과를 캐시에 저장한다.

2. 데이터 업데이트
> 콘서트 예약 가능한 날짜가 변경되면 DB에 저장하다  
> 캐시에서 해당 데이터를 삭제하거나 변경된 날짜 정보를 반영하여 캐시를 갱신한다.
> 캐시와 DB간의 데이터 일관성을 유지할수 있다.

결론 : 자주 조회되는 데이터에 대해 캐시를 활용함으로써 DB 부하를 줄이고 빠른 응답을 제공하고  
데이터 변경이 있을때 캐시와 DB 모두 최신 데이터를 반영하도록 처리하여 데이터가 일관성 있게 사용하는 전략이 좋을거같습니다.
추가적으로 캐시를 먼저 확인하고 캐시 미스 시에만 DB를 조회하여 네트워크 트래픽을 줄이고 데이터 조회의 효율성을 높힐거 같습니다.